<p-dialog
  [header]="title"
  class="flex"
  [(visible)]="open"
  (visibleChange)="onOpenChange($event)"
  [modal]="true"
  [style]="{ width: '95vw', height: '80vh' }"
  [contentStyle]="{ display: 'flex', flexDirection: 'column', height: '100%' }"
  [maximizable]="false"
  [draggable]="false"
  [resizable]="false"
  (onShow)="handleOnShow()"
>
  <div class="flex flex-col h-full overflow-hidden">
    <div class="flex items-center justify-between gap-2">
      <div class="py-4">
        <label for="session-name" class="block text-sm font-medium text-gray-700 mb-2">Color</label>
        <div class="flex items-center justify-between gap-2 p-2.5 bg-gray-300 rounded-lg">
          <p-colorpicker
            [(ngModel)]="color"
            inputId="cp-hex"
            style="border: 1px solid #364153; border-radius: 0.4rem"
          />
        </div>
      </div>

      <div class="py-4 w-full">
        <label for="session-name" class="block text-sm font-medium text-gray-700 mb-2"
          >Session Name</label
        >
        <input
          id="session-name"
          type="text"
          [(ngModel)]="name"
          class="w-full px-3 py-2.5 border border-blue-500 rounded-lg focus:ring-2 transition-colors placeholder:opacity-50"
          placeholder="e.g., Upper Body Power"
        />
      </div>
    </div>

    <div class="flex-1 overflow-y-auto space-y-4">
      @for (exercise of exercises; track $index) {
        <div
          class="bg-white rounded-md p-4 shadow-sm border text-black flex items-center justify-between"
        >
          <div class="flex items-center space-x-3">
            <div class="bg-blue-600 h-2 w-2 rounded-full relative">
              <span class="absolute bg-blue-600 inset-0 rounded-full animate-ping"></span>
            </div>
            <span>{{ exercise.name }}</span>
          </div>

          <button class="text-blue-500 cursor-pointer" (click)="removeExercise($index)">
            <i class="pi pi-trash text-xs"></i>
          </button>
        </div>
      }
    </div>
  </div>

  <div class="flex flex-col gap-4 pt-4 shrink-0">
    <p-button
      label="Add Exercise"
      icon="pi pi-plus"
      (onClick)="showAddExercise = true"
      styleClass="w-full p-button-md p-button-outlined"
    >
    </p-button>
    <div class="flex space-x-3">
      <button
        class="flex-1 cursor-pointer px-4 py-2.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors font-medium"
        (click)="cancelSessionCreation()"
      >
        Cancel
      </button>
      <button
        class="flex-1 cursor-pointer px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium"
        (click)="handleExecuteAction()"
      >
        {{ buttonLabel }}
      </button>
    </div>
  </div>
</p-dialog>

<add-exercise-dialog
  [(open)]="showAddExercise"
  (openChange)="showAddExercise = $event"
  (exerciseAdded)="onExerciseAdded($event)"
></add-exercise-dialog>
