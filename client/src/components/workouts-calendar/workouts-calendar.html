<div class="w-full max-w-4xl mx-auto p-4">
  <!-- Header with Navigation -->
  <div class="flex items-center justify-between mb-6">
    <button
      (click)="prevMonth()"
      class="p-2 hover:bg-gray-100 rounded-lg transition-colors"
      aria-label="Previous month"
    >
      <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
    </button>

    <div class="flex items-center gap-3">
      <h2 class="text-xl font-semibold text-gray-800">
        {{ currentMonthYear }}
      </h2>
      <button
        (click)="goToToday()"
        class="px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded-md transition-colors"
      >
        Today
      </button>
    </div>

    <button
      (click)="nextMonth()"
      [disabled]="!canGoNextMonth()"
      class="p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50"
      aria-label="Next month"
    >
      <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>

  <!-- Weekday Labels -->
  <div class="grid grid-cols-7 gap-1 mb-2">
    <div
      *ngFor="let day of weekdayLabels"
      class="text-center text-sm font-medium text-gray-500 py-2"
    >
      {{ day }}
    </div>
  </div>

  <!-- Calendar Grid -->
  <div class="grid grid-cols-7 gap-1">
    @for (week of weeks; track $index) {
      <ng-container>
        @for (date of week; track $index) {
          <div
            [class.opacity-0]="!date"
            [class.pointer-events-none]="!date"
            class="relative min-h-24 border border-gray-200 rounded-lg p-2 transition-all hover:shadow-md hover:border-gray-300 cursor-pointer"
            [class.border-blue-500]="isDateToday(date)"
            [class.bg-blue-50]="isDateToday(date)"
            [class.bg-white]="!isDateToday(date)"
            (click)="onDayClick(date)"
            [attr.aria-label]="date ? date.toDateString() : ''"
          >
            @if (date) {
              <div
                class="text-sm font-medium mb-1"
                [class.text-blue-600]="isDateToday(date)"
                [class.text-gray-700]="!isDateToday(date)"
              >
                {{ date.getDate() }}
              </div>
            }

            @if (date) {
              <div class="flex flex-wrap gap-1 mt-auto">
                @for (event of getEventsForDate(date); track event._id) {
                  <div
                    class="w-2 h-2 rounded-full"
                    [style.background-color]="getColorForEvent(event)"
                  ></div>
                }
              </div>
            }
          </div>
        }
      </ng-container>
    }
  </div>
</div>
