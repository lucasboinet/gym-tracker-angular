<div class="px-4 pb-20">
  <!-- Start Screen -->
  @if (!this.gymService.currentWorkout()) {
    <no-active-workout (startWorkout)="startWorkout()"></no-active-workout>
  }

  <!-- Active Workout -->
  @if (this.gymService.currentWorkout()) {
    <div class="py-4 flex flex-col gap-4">
      <!-- Workout Info Card -->
      <div class="bg-white rounded-xl p-4 shadow-sm border">
        <div class="flex items-center justify-between mb-2">
          <h3 class="font-semibold text-gray-900">Today's Workout</h3>
          <span
            class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
          >
            <div class="w-2 h-2 bg-green-400 rounded-full mr-1.5 animate-pulse"></div>
            Active
          </span>
        </div>
        <p class="text-sm text-gray-600">
          Started at {{ this.gymService.currentWorkout()!.startTime }}
        </p>
      </div>

      <!-- Exercises -->
      @for (exercise of this.gymService.exercises(); track exercise._id) {
        <exercise-card
          [exercise]="exercise"
          [workoutId]="this.gymService.currentWorkout()?._id"
          (addSet)="addSet($event)"
          (removeExercise)="removeExercise($event)"
          (removeSet)="removeSet($event.id, $event.index)"
          (updateSet)="updateSet($event.id, $event.index, $event.type, $event.value)"
        />
      }

      <!-- Add Exercise Button -->
      <p-button
        label="Add Exercise"
        icon="pi pi-plus"
        (onClick)="showAddExercise = true"
        styleClass="w-full p-button-lg p-button-outlined"
      >
      </p-button>
    </div>

    <!-- Fixed Bottom Actions -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t p-4 flex justify-between">
      <p-button
        label="Cancel"
        icon="pi pi-times"
        (onClick)="confirmCancelWorkout()"
        styleClass="p-button-danger p-button-outlined"
      >
      </p-button>

      <p-button
        label="Finish"
        icon="pi pi-check"
        (onClick)="finishWorkout()"
        styleClass="p-button-success"
      >
      </p-button>
    </div>
  }
</div>

<!-- Add Exercise Dialog -->
<add-exercise-dialog
  [(open)]="showAddExercise"
  (exerciseAdded)="addExercise($event)"
></add-exercise-dialog>
